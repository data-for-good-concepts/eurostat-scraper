steps:
- name: 'gcr.io/cloud-builders/docker'
  entrypoint: 'bash'
  args: ['-c', 'docker pull gcr.io/$PROJECT_ID/$_SERVICE_NAME:latest || exit 0']
- name: 'gcr.io/cloud-builders/docker'
  args: [
            'build',
            '--tag', 'gcr.io/$PROJECT_ID/$_SERVICE_NAME:latest',
            '--cache-from', 'gcr.io/$PROJECT_ID/$_SERVICE_NAME:latest',
            '.'
        ]
- name: 'r-server'
  entrypoint: 'RScript'
  args: ['-e', 'server.R']
images: ['gcr.io/$PROJECT_ID/$_SERVICE_NAME:latest']
options:
  substitutionOption: ALLOW_LOOSE
substitutions:
  _SERVICE_NAME: eurostat-scraper
